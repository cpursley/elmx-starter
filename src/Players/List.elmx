module Players.List exposing (..)

import Html exposing (..)
import Html.Attributes exposing (class)
import Msgs exposing (Msg)
import Models exposing (Player)
import RemoteData exposing (WebData)


-- LIST VIEW


view : WebData (List Player) -> Html Msg
view response =
    let
        listView =
            maybeList response
    in
        <div>
          {nav}
          {listView}
        </div>


nav : Html Msg
nav =
    <div class="clearfix mb2 white bg-black">
      <div class="left p2">Players</div>
    </div>


maybeList : WebData (List Player) -> Html Msg
maybeList response =
    case response of
        RemoteData.NotAsked ->
            <span></span>

        RemoteData.Loading ->
            <span>Loading...</span>

        RemoteData.Success players ->
            list players

        RemoteData.Failure error ->
            let
                errorMessage =
                    error |> toString
            in
                <span>{=errorMessage}</span>


list : List Player -> Html Msg
list players =
    let
        tableData =
            players |> List.map playerRow
    in
        <div class="p2">
          <table>
            <thead>
              <tr>
                <th>Id</th>
                <th>Name</th>
                <th>Level</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              {:tableData}
            </tbody>
          </table>
        </div>


playerRow : Player -> Html Msg
playerRow player =
    let
        playerLevel =
            player.level |> toString
    in
        <tr>
          <td>{=player.id}</td>
          <td>{=player.name}</td>
          <td>{=playerLevel}</td>
          <td></td>
        </tr>
